---
title: "DESeq2 Exercises"
author: 'Anya Greenberg (stemaway: durberg7)'
date: "6/18/2020"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

### Exercise 1

##### How many adjusted p-values were less than 0.1

```{r eval=FALSE}
> summary(res)

out of 19748 with nonzero total read count
adjusted p-value < 0.1
LFC > 0 (up)       : 3582, 18%
LFC < 0 (down)     : 3847, 19%
outliers [1]       : 0, 0%
low counts [2]     : 3413, 17%
(mean count < 3)
[1] see 'cooksCutoff' argument of ?results
[2] see 'independentFiltering' argument of ?results
```

```{r}
cat("Adjusted p-values less than 0.1:", 3582+3847)
```

### Exercise 2

##### Explore the results table summary for the Mov10_knockdown comparison to control. How many genes are differentially expressed at FDR < 0.1? How many fewer genes do we find at FDR < 0.05?

```{r eval=FALSE}
> res_1 <- results(dds, contrast=c("sampletype", "MOV10_knockdown", "control"))
> summary(res_1)

out of 19748 with nonzero total read count
adjusted p-value < 0.1
LFC > 0 (up)       : 3112, 16%
LFC < 0 (down)     : 2727, 14%
outliers [1]       : 0, 0%
low counts [2]     : 4171, 21%
(mean count < 5)
[1] see 'cooksCutoff' argument of ?results
[2] see 'independentFiltering' argument of ?results


> res_05 <- results(dds, contrast=c("sampletype", "MOV10_knockdown", "control"), alpha=0.05)
> summary(res_05)

out of 19748 with nonzero total read count
adjusted p-value < 0.05
LFC > 0 (up)       : 2668, 14%
LFC < 0 (down)     : 2241, 11%
outliers [1]       : 0, 0%
low counts [2]     : 4171, 21%
(mean count < 5)
[1] see 'cooksCutoff' argument of ?results
[2] see 'independentFiltering' argument of ?results

```

```{r}
cat("Genes differentially expressed at FDR < 0.1:", 3112+2727, "\n")
cat("Genes differentially expressed at FDR < 0.05:", 2668+2241, "\n")
cat("Difference:", 5839-4909)
```

### Exercise 3

##### Make a volcano plot of the results for the Mov10_knockdown comparison to control and write down a small description of your plot (max. 5 lines)

```{r eval=FALSE}
res <- results(dds, contrast=c("sampletype", "MOV10_knockdown", "control"))
df <- as.data.frame(res@listData)
rownames(df) <- rownames(data)
df <- df[complete.cases(df),] 

volcano_plot <- EnhancedVolcano(df,
                               lab=rownames(df),
                               pCutoff=0.01,
                               FCcutoff=0.5,
                               x="log2FoldChange",
                               y="padj",
                               pointSize=1,
                               legendLabSize=10,
                               xlim=c(-3,3),
                               labSize=3.0)
```

<div style="text-align:center">
<img src="C:/USers/durbe/Documents/repositories/figures/StemAway/R_12Jun_VolcanoPlot.png"alt="Volcano Plot">
</div>

The points on left are down-regulated and hte ones on the right are upregulated. The red points have statistically significant p-values and log fold changes whereas the blue points have statistically significant p-values but not log fold changes. Green points have statistically significant log fold changes but not p-values and the grey are not significant.

The APLP2 and NID1 genes are the most significant upregulated  since they have the  smallest p-value (largest negative-logged p). MAT2B and AKT3 are the most significant downregulated.
